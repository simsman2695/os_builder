# rk3588-tyr.config — Kernel config fragment for Tyr (Rust) GPU driver on RK3588
#
# Tyr is an experimental Rust DRM driver for Arm Mali Valhall GPUs (Mali-G610).
# It uses the same Panthor uAPI, so the entire Mesa userspace and firmware are
# identical to the Panthor setup.  Requires LLVM=1 for Rust kernel support.

# ── Disable unnecessary GPU drivers (speeds up build, avoids conflicts) ──────
# CONFIG_DRM_NOUVEAU is not set
# CONFIG_DRM_RADEON is not set
# CONFIG_DRM_AMDGPU is not set
# CONFIG_DRM_I915 is not set
# CONFIG_DRM_XE is not set
# CONFIG_DRM_VMWGFX is not set
# CONFIG_DRM_VGEM is not set
# CONFIG_DRM_QXL is not set
# CONFIG_DRM_VIRTIO_GPU is not set
# CONFIG_DRM_VKMS is not set
# CONFIG_DRM_AST is not set
# CONFIG_DRM_MGAG200 is not set
# CONFIG_DRM_CIRRUS_QEMU is not set
# CONFIG_DRM_BOCHS is not set

# ── Disable x86/PC media drivers that fail on ARM64 ──────────────────────────
# CONFIG_VIDEO_CX18 is not set
# CONFIG_VIDEO_IVTV is not set
# CONFIG_VIDEO_FB_IVTV is not set
# CONFIG_DVB_DDBRIDGE is not set
# CONFIG_DVB_NETUP_UNIDVB is not set
# CONFIG_DVB_SMIPCIE is not set
# CONFIG_VIDEO_COBALT is not set
# CONFIG_DVB_PT3 is not set
# CONFIG_RADIO_SI4713 is not set
# CONFIG_USB_SI4713 is not set
# CONFIG_I2C_SI4713 is not set
# CONFIG_PLATFORM_SI4713 is not set

# ── Disable Panthor (avoid conflict with Tyr) ────────────────────────────────
# CONFIG_DRM_PANTHOR is not set

# ── Rust support (required for Tyr) ──────────────────────────────────────────
CONFIG_RUST=y

# ── Tyr GPU driver ───────────────────────────────────────────────────────────
# Must be =m (not =y) so the driver loads after rootfs is mounted,
# otherwise firmware load fails because /lib/firmware isn't available yet.
CONFIG_DRM_TYR=m

# ── RK3588 platform essentials ───────────────────────────────────────────────
CONFIG_ARCH_ROCKCHIP=y
CONFIG_ROCKCHIP_IOMMU=y
CONFIG_PHY_ROCKCHIP_NANENG_COMBO_PHY=y
CONFIG_PHY_ROCKCHIP_USBDP=y

# ── Power management ─────────────────────────────────────────────────────────
CONFIG_PM_DEVFREQ=y
CONFIG_DEVFREQ_GOV_SIMPLE_ONDEMAND=y

# ── Display / framebuffer ────────────────────────────────────────────────────
CONFIG_DRM=y
CONFIG_DRM_ROCKCHIP=y
CONFIG_ROCKCHIP_VOP2=y
CONFIG_ROCKCHIP_DW_HDMI_QP=y
CONFIG_DRM_DW_HDMI_CEC=y

# ── Rocket NPU accelerator (Linux 6.18+, ignored on older kernels) ────────
CONFIG_DRM_ACCEL=y
CONFIG_DRM_ACCEL_ROCKET=m
