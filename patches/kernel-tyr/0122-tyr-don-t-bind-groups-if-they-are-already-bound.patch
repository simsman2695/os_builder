From 8be16929205a2ac70609e10f9eee2b4d6a0913a3 Mon Sep 17 00:00:00 2001
From: Daniel Almeida <daniel.almeida@collabora.com>
Date: Fri, 17 Oct 2025 09:29:58 -0300
Subject: [PATCH 122/161] tyr: don't bind groups if they are already bound

---
 drivers/gpu/drm/tyr/sched.rs | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/drivers/gpu/drm/tyr/sched.rs b/drivers/gpu/drm/tyr/sched.rs
index 62141b8c5a..3e3ccbe032 100644
--- a/drivers/gpu/drm/tyr/sched.rs
+++ b/drivers/gpu/drm/tyr/sched.rs
@@ -376,6 +376,13 @@ fn program_cs_slot(&mut self, queue: &Queue, cs_iface: &mut CommandStream) -> Re
     }
 
     pub(crate) fn bind(&mut self, tdev: &TyrDevice, group: Arc<Group>) -> Result {
+        let already_bound = group.with_locked_inner(|inner| Ok(inner.csg_id.is_some()))?;
+
+        if already_bound {
+            let csg_id = group.with_locked_inner(|inner| Ok(inner.csg_id.unwrap()))?;
+            return Ok(());
+        }
+
         let csg_idx = self
             .csg_slots
             .iter()
-- 
2.51.0

